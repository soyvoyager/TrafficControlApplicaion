from owslib.wms import WebMapService
#owslib package is helpful for installing aerial images with Web Map Service
URL = "https://geodata.nationaalgeoregister.nl/luchtfoto/rgb/wms?request=GetCapabilities"
#this link is the satellite image for getting the aerial images of Netherland region. Freely accessible and no restrains.
wms = WebMapService(URL, version='1.1.1')
 
OP_DIR = "C:/Users/a/Desktop/image_tiles_200"
#dirctory for saving the tiles 
x_min = 90000
y_min = 427000
dx, dy = 200, 200
#With “da” and “db” is defined here for adjusting zooming level of Tiles. A values of 200~12, and a value 100~13(Zoom level).
no_tiles_x = 100
no_tiles_y = 100
tot_no_tiles = no_tiles_x * no_tiles_y
x_max = x_min + no_tiles_x * dx
y_max = y_min + no_tiles_y * dy
BOUNDING_BOX = [x_min, y_min, x_max, y_max]
#lower left a and b as well as upper right a nd b co-ods are used in file name so it will always know where the tile is located...
for mm in range(0,no_tiles_x):
    print(mm)
    for nn in range(0,no_tiles_y):
        ll_x_ = x_min + ii*dx
        ll_y_ = y_min + jj*dy
        bbox = (ll_x_, ll_y_, ll_x_ + dx, ll_y_ + dy) 
        img = wms.getmap(layers=['Actueel_ortho25'], srs='EPSG:28992', bbox=bbox, size=(256, 256), format='image/jpeg', transparent=True)
        filename = "{}_{}_{}_{}.jpg".format(bbox[0], bbox[1], bbox[2], bbox[3])
        out = open(OP_DIR + filename, 'wb')
        out.write(img.read())
        out.close()
